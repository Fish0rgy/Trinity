using Trinity.Utilities;
using Trinity.SDK.Photon;
using ExitGames.Client.Photon;
using MelonLoader;
using System;
using System.Collections;
using UnityEngine;
using Trinity.SDK;
using VRC.SDKBase;

namespace Trinity.Module.Exploit
{
    internal class SendRPCDebug : BaseModule
    {
        public SendRPCDebug() : base("SendRPC", "Debug\\Testing.", Main.Instance.Eventexploitbutton, null, true, false) { }

        public override void OnEnable()
        {
            MelonCoroutines.Start(SendRPC("Discord.gg/copyandpasted Trinity Client On Top"));
        }

        public IEnumerator SendRPC(string value)
        {
            while (this.toggled)
            {
                try
                {
                    VRC_EventHandler.VrcEvent vrcEvent = new VRC_EventHandler.VrcEvent
                    {
                        EventType = VRC_EventHandler.VrcEventType.SendRPC,
                        ParameterObject = Networking.SceneEventHandler.gameObject,
                        ParameterInt = 1,
                        ParameterFloat = 0f,
                        ParameterString = value,
                    };
                    Networking.SceneEventHandler.TriggerEvent(vrcEvent, VRC_EventHandler.VrcBroadcastType.AlwaysUnbuffered, PU.GetPlayer().gameObject, 0f);
                }
                catch
                {
                }
                yield return new WaitForSecondsRealtime(0.1f);
            }
            yield break;
        }
    }
}
